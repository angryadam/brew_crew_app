<% if @post.comments.present? %>
  <nav class="panel">
    <p class="panel-heading">
      <%= comment_heading_text(num_of_comments: @post.comments.size) %>
    </p>
    <div id="post-comments">
      <% @post.comments.each do |comment| %>
        <div class="card">
          <div class="card-content">

            <nav class="level is-mobile">
              <div class="level-left">
                <h5 class="title is-size-5">
                  <%= comment.commented_by.name.familiar %>
                </h5>
              </div>
              <div class="level-right">
                <% if policy(comment).destroy? %>
                  <%= link_to crew_user_post_comment_path(@crew, current_user, @post, comment),
                              data: { behavior: 'delete-comment' }, class: 'button is-text' do %>
                    <i class="fas fa-trash"></i>
                    Delete
                  <% end %>
                <% end %>
              </div>
            </nav>

            <div class="content"><%= comment.text %></div>
          </div>
        </div>
      <% end %>
    </div>
  </nav>
<% end %>

<button class="button is-text" id="add-comment-button">
  <i class="fas fa-plus"></i>
  Comment
</button>

<%= form_with model: [@crew, current_user, @post, Comment.new],
              local: true, id: 'create-comment-form' do |f| %>
  <div class="field">
    <div class="control">
      <%= f.text_area :text,
                      placeholder: 'Write your comment here...',
                      required: true, class: 'textarea' %>
    </div>
  </div>

  <div class="field">
    <div class="control">
      <%= f.submit 'Save', class: 'button is-primary' %>
    </div>
  </div>
<% end %>
